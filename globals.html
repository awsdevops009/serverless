

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Globals Section &mdash; Serverless Application Model 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Serverless Application Model 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="Safe Lambda deployments" href="safe_lambda_deployments.html"/>
        <link rel="prev" title="Create &amp; deploy serverless applications" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Serverless Application Model
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Globals Section</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-resources-and-properties">Supported Resources and Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implicit-apis">Implicit APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unsupported-properties">Unsupported Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overridable">Overridable</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primitive-values-are-replaced">Primitive Values are replaced</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maps-are-merged">Maps are merged</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lists-are-additive">Lists are additive</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="safe_lambda_deployments.html">Safe Lambda deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy_templates.html">Policy Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/index.html">SAM Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Serverless Application Model</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Globals Section</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/globals.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="globals-section">
<h1><a class="toc-backref" href="#id1">Globals Section</a><a class="headerlink" href="#globals-section" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#globals-section" id="id1">Globals Section</a><ul>
<li><a class="reference internal" href="#supported-resources-and-properties" id="id2">Supported Resources and Properties</a><ul>
<li><a class="reference internal" href="#implicit-apis" id="id3">Implicit APIs</a></li>
<li><a class="reference internal" href="#unsupported-properties" id="id4">Unsupported Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overridable" id="id5">Overridable</a><ul>
<li><a class="reference internal" href="#primitive-values-are-replaced" id="id6">Primitive Values are replaced</a></li>
<li><a class="reference internal" href="#maps-are-merged" id="id7">Maps are merged</a></li>
<li><a class="reference internal" href="#lists-are-additive" id="id8">Lists are additive</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Resources in a SAM template tend to have shared configuration such as Runtime, Memory,
VPC Settings, Environment Variables, Cors, etc. Instead of duplicating this information in every resource, you can
write them once in the <code class="docutils literal"><span class="pre">Globals</span></code> section and let all resources inherit it.</p>
<p>Example:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span> <span class="n">nodejs6</span><span class="o">.</span><span class="mi">10</span>
    <span class="n">Timeout</span><span class="p">:</span> <span class="mi">180</span>
    <span class="n">Handler</span><span class="p">:</span> <span class="n">index</span><span class="o">.</span><span class="n">handler</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="n">data</span><span class="o">-</span><span class="n">table</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">HelloWorldFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">MESSAGE</span><span class="p">:</span> <span class="s2">&quot;Hello From SAM&quot;</span>

  <span class="n">ThumbnailFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Events</span><span class="p">:</span>
        <span class="n">Thumbnail</span><span class="p">:</span>
          <span class="n">Type</span><span class="p">:</span> <span class="n">Api</span>
          <span class="n">Properties</span><span class="p">:</span>
            <span class="n">Path</span><span class="p">:</span> <span class="o">/</span><span class="n">thumbnail</span>
            <span class="n">Method</span><span class="p">:</span> <span class="n">POST</span>
</pre></div>
</div>
<p>In the above example, both <code class="docutils literal"><span class="pre">HelloWorldFunction</span></code> and <code class="docutils literal"><span class="pre">ThumbnailFunction</span></code> will use nodejs6.10 runtime, 180 seconds
timeout and index.handler Handler. <code class="docutils literal"><span class="pre">HelloWorldFunction</span></code> adds MESSAGE environment variable in addition to the
inherited TABLE_NAME. <code class="docutils literal"><span class="pre">ThumbnailFunction</span></code> inherits all the Globals properties and adds an API Event source.</p>
<div class="section" id="supported-resources-and-properties">
<h2><a class="toc-backref" href="#id2">Supported Resources and Properties</a><a class="headerlink" href="#supported-resources-and-properties" title="Permalink to this headline">¶</a></h2>
<p>Currently, the following resources and properties are being supported:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="c1"># Properties of AWS::Serverless::Function</span>
    <span class="n">Handler</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span>
    <span class="c1"># Specifying CodeUri on Globals is not yet supported by &#39;CloudFormation package&#39; https://docs.aws.amazon.com/cli/latest/reference/cloudformation/package.html</span>
    <span class="n">CodeUri</span><span class="p">:</span>
    <span class="n">DeadLetterQueue</span><span class="p">:</span>
    <span class="n">Description</span><span class="p">:</span>
    <span class="n">MemorySize</span><span class="p">:</span>
    <span class="n">Timeout</span><span class="p">:</span>
    <span class="n">VpcConfig</span><span class="p">:</span>
    <span class="n">Environment</span><span class="p">:</span>
    <span class="n">Tags</span><span class="p">:</span>
    <span class="n">Tracing</span><span class="p">:</span>
    <span class="n">KmsKeyArn</span><span class="p">:</span>
    <span class="n">Layers</span><span class="p">:</span>
    <span class="n">AutoPublishAlias</span><span class="p">:</span>
    <span class="n">DeploymentPreference</span><span class="p">:</span>

  <span class="n">Api</span><span class="p">:</span>
    <span class="c1"># Properties of AWS::Serverless::Api</span>
    <span class="c1"># Also works with Implicit APIs</span>
    <span class="n">Name</span><span class="p">:</span>
    <span class="n">DefinitionUri</span><span class="p">:</span>
    <span class="n">CacheClusterEnabled</span><span class="p">:</span>
    <span class="n">CacheClusterSize</span><span class="p">:</span>
    <span class="n">Variables</span><span class="p">:</span>
    <span class="n">EndpointConfiguration</span><span class="p">:</span>
    <span class="n">MethodSettings</span><span class="p">:</span>
    <span class="n">BinaryMediaTypes</span><span class="p">:</span>
    <span class="n">Cors</span><span class="p">:</span>

  <span class="n">SimpleTable</span><span class="p">:</span>
    <span class="c1"># Properties of AWS::Serverless::SimpleTable</span>
    <span class="n">SSESpecification</span>
</pre></div>
</div>
<div class="section" id="implicit-apis">
<h3><a class="toc-backref" href="#id3">Implicit APIs</a><a class="headerlink" href="#implicit-apis" title="Permalink to this headline">¶</a></h3>
<p>APIs created by SAM when you have an API declared in the <code class="docutils literal"><span class="pre">Events</span></code> section are called “Implicit APIs”. You can use
Globals to override all properties of Implicit APIs as well.</p>
</div>
<div class="section" id="unsupported-properties">
<h3><a class="toc-backref" href="#id4">Unsupported Properties</a><a class="headerlink" href="#unsupported-properties" title="Permalink to this headline">¶</a></h3>
<p>Following properties are <strong>not</strong> supported in Globals section. We made the explicit
call to not support them because it either made the template hard to understand or opened scope for potential security
issues.</p>
<p><strong>AWS::Serverless::Function:</strong></p>
<ul class="simple">
<li>Role</li>
<li>Policies</li>
<li>FunctionName</li>
<li>Events</li>
</ul>
<p><strong>AWS::Serverless::Api:</strong></p>
<ul class="simple">
<li>StageName</li>
<li>DefinitionBody</li>
</ul>
</div>
</div>
<div class="section" id="overridable">
<h2><a class="toc-backref" href="#id5">Overridable</a><a class="headerlink" href="#overridable" title="Permalink to this headline">¶</a></h2>
<p>Properties declared in the Globals section can be overriden by the resource. For example, you can add new Variables
to environment variable map or override globally declared variables. But the resource <strong>cannot</strong> remove a property
specified in globals environment variables map. More generally, Globals declare properties shared by all your resources.
Some resources can provide new values for globally declared properties but cannot completely remove them. If some
resources use a property but others do not, then you must not declare them in the Globals section.</p>
<p>Here is how overriding works for various data types:</p>
<div class="section" id="primitive-values-are-replaced">
<h3><a class="toc-backref" href="#id6">Primitive Values are replaced</a><a class="headerlink" href="#primitive-values-are-replaced" title="Permalink to this headline">¶</a></h3>
<p><em>String, Number, Boolean etc</em></p>
<p>Value specified in the resource will <strong>replace</strong> Global value</p>
<p>Example:</p>
<p>Runtime of <code class="docutils literal"><span class="pre">MyFunction</span></code> will be set to python3.6</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span> <span class="n">nodejs4</span><span class="o">.</span><span class="mi">3</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Runtime</span><span class="p">:</span> <span class="n">python3</span><span class="o">.</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="maps-are-merged">
<h3><a class="toc-backref" href="#id7">Maps are merged</a><a class="headerlink" href="#maps-are-merged" title="Permalink to this headline">¶</a></h3>
<p><em>Maps are also known as dictionaries or collections of key/value pairs</em></p>
<p>Map entries in the resource will be <strong>merged</strong> with global map entries. In case of duplicates the resource entry will override the global entry.</p>
<p>Example:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">STAGE</span><span class="p">:</span> <span class="n">Production</span>
        <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="k">global</span><span class="o">-</span><span class="n">table</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Environment</span><span class="p">:</span>
        <span class="n">Variables</span><span class="p">:</span>
          <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="n">resource</span><span class="o">-</span><span class="n">table</span>
          <span class="n">NEW_VAR</span><span class="p">:</span> <span class="n">hello</span>
</pre></div>
</div>
<p>In the above example the environment variables of <code class="docutils literal"><span class="pre">MyFunction</span></code> will be set to:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;STAGE&quot;</span><span class="p">:</span> <span class="s2">&quot;Production&quot;</span><span class="p">,</span>
  <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="s2">&quot;resource-table&quot;</span><span class="p">,</span>
  <span class="s2">&quot;NEW_VAR&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="lists-are-additive">
<h3><a class="toc-backref" href="#id8">Lists are additive</a><a class="headerlink" href="#lists-are-additive" title="Permalink to this headline">¶</a></h3>
<p><em>Lists are also known as arrays</em></p>
<p>Global entries will be <strong>prepended</strong> to the list in the resource.</p>
<p>Example:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">VpcConfig</span><span class="p">:</span>
      <span class="n">SecurityGroupIds</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="mi">123</span>
        <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="mi">456</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">VpcConfig</span><span class="p">:</span>
        <span class="n">SecurityGroupIds</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="n">first</span>
</pre></div>
</div>
<p>In the above example the Security Group Ids of <code class="docutils literal"><span class="pre">MyFunction</span></code>’s VPC Config will be set to:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="s2">&quot;sg-123&quot;</span><span class="p">,</span> <span class="s2">&quot;sg-456&quot;</span><span class="p">,</span> <span class="s2">&quot;sg-first&quot;</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="safe_lambda_deployments.html" class="btn btn-neutral float-right" title="Safe Lambda deployments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Create &amp; deploy serverless applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Amazon Web Services.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>